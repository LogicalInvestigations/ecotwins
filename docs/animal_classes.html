---

title: Ecosystems


keywords: fastai
sidebar: home_sidebar



nb_path: "animal_classes.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: animal_classes.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Google-Colab-preparations">Google Colab preparations<a class="anchor-link" href="#Google-Colab-preparations"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span> <span class="ow">and</span> <span class="n">IN_MAIN</span><span class="p">:</span>
    <span class="n">home_dir</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Colab Notebooks/Ecosystems/v3&#39;</span>
<span class="k">if</span> <span class="n">IN_COLAB</span> <span class="ow">and</span> <span class="n">IN_MAIN</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
    <span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">home_dir</span><span class="p">)</span>
    <span class="o">%</span><span class="k">cd</span> $home_dir
    
<span class="o">!</span>pip -q install import-ipynb
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modules">Modules<a class="anchor-link" href="#Modules"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_objects" class="doc_header"><code>generate_objects</code><a href="https://github.com/LogicalInvestigations/ecotwins/tree/master/ecotwins/animal_classes.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_objects</code>(<strong><code>side</code></strong>=<em><code>None</code></em>, <strong><code>n_objects</code></strong>=<em><code>10</code></em>)</p>
</blockquote>
<p>Generates a random map of objects
param side: size of each side of the grid
param n_objects: (initial) number of objects in the ecosystem</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Terrain">Terrain<a class="anchor-link" href="#Terrain"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Terrain" class="doc_header"><code>class</code> <code>Terrain</code><a href="https://github.com/LogicalInvestigations/ecotwins/tree/master/ecotwins/animal_classes.py#L59" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Terrain</code>(<strong><code>space</code></strong>:<code>Tuple</code>[<code>List</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>conditions</code></strong>:<code>Callable</code>[<code>List</code>[<code>int</code>], <code>Dict</code>[<code>str</code>, <code>int</code>]]=<em><code>&lt;factory&gt;</code></em>, <strong><code>objects</code></strong>:<code>Dict</code>[<code>str</code>, <code>List</code>[<code>Any</code>]]=<em><code>&lt;factory&gt;</code></em>, <strong><code>counter</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>torus</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Terrain(space: Tuple[List] = <factory>, conditions: Callable[[List[int]], Dict[str, int]] = <factory>, objects: Dict[str, List[Any]] = <factory>, counter: int = 0, torus: bool = False)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Organism">Organism<a class="anchor-link" href="#Organism"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Organism" class="doc_header"><code>class</code> <code>Organism</code><a href="https://github.com/LogicalInvestigations/ecotwins/tree/master/ecotwins/animal_classes.py#L188" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Organism</code>(<strong><code>species</code></strong>:<code>str</code>, <strong><code>genome</code></strong>:<code>str</code>, <strong><code>sex</code></strong>:<code>str</code>, <strong><code>age</code></strong>:<code>float</code>, <strong><code>weight</code></strong>:<code>float</code>, <strong><code>position</code></strong>:<code>Any</code>, <strong><code>hyperparameters</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>min_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>max_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>homeostatic_effects</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]) :: <code>ABC</code></p>
</blockquote>
<p>Organism(species: str, genome: str, sex: str, age: float, weight: float, position: Any, hyperparameters: Dict[str, float], homeostasis: Dict[str, float], min_homeostasis: Dict[str, float], max_homeostasis: Dict[str, float], homeostatic_effects: Dict[str, float])</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plants">Plants<a class="anchor-link" href="#Plants"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Plant</span><span class="p">(</span><span class="n">Organism</span><span class="p">):</span> 
     <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Dandelion">Dandelion<a class="anchor-link" href="#Dandelion"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dandelion_def</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;dandelion&#39;</span><span class="p">,</span>
    <span class="s1">&#39;genome&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span>
    <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
    <span class="s1">&#39;homeostasis&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> 
        <span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;min_homeostasis&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;water&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;max_homeostasis&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;water&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;homeostatic_effects&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="p">(</span><span class="s1">&#39;idle&#39;</span><span class="p">,</span><span class="s1">&#39;water&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="s1">&#39;hyperparameters&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># Biological</span>
        <span class="s1">&#39;max_age&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> 
        <span class="c1"># Physical</span>
        <span class="s1">&#39;close&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="c1"># distance for mating</span>
    <span class="p">},</span>
<span class="p">}</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> <span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Dandelion</span><span class="p">(</span><span class="n">Plant</span><span class="p">):</span>
    <span class="n">species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span>
    <span class="n">genome</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;genome&#39;</span><span class="p">]</span>
    <span class="n">sex</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">])</span>
    <span class="n">hyperparameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;hyperparameters&#39;</span><span class="p">])</span>
    <span class="n">homeostasis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;homeostasis&#39;</span><span class="p">])</span>
    <span class="n">min_homeostasis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;min_homeostasis&#39;</span><span class="p">])</span>
    <span class="n">max_homeostasis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;max_homeostasis&#39;</span><span class="p">])</span>
    <span class="n">homeostatic_effects</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">dandelion_def</span><span class="p">[</span><span class="s1">&#39;homeostatic_effects&#39;</span><span class="p">])</span>
   
    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="sd">&#39;&#39;&#39;It is alive if the water and energy levels are ok and it is not too old&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">homeostasis</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_homeostasis</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">homeostasis</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_homeostasis</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">]</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">homeostasis</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_homeostasis</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">max_homeostasis</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">homeostasis</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span> <span class="ow">and</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">[</span><span class="s1">&#39;max_age&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span>
    <span class="n">dandelion1</span> <span class="o">=</span> <span class="n">Dandelion</span><span class="p">()</span>
    <span class="n">dandelion1</span><span class="o">.</span><span class="n">alive</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Animals">Animals<a class="anchor-link" href="#Animals"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Animal" class="doc_header"><code>class</code> <code>Animal</code><a href="https://github.com/LogicalInvestigations/ecotwins/tree/master/ecotwins/animal_classes.py#L217" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Animal</code>(<strong><code>species</code></strong>:<code>str</code>, <strong><code>genome</code></strong>:<code>str</code>, <strong><code>sex</code></strong>:<code>str</code>, <strong><code>age</code></strong>:<code>float</code>, <strong><code>weight</code></strong>:<code>float</code>, <strong><code>position</code></strong>:<code>Any</code>, <strong><code>hyperparameters</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>min_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>max_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>homeostatic_effects</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>], <strong><code>distances</code></strong>:<code>Dict</code>, <strong><code>perception</code></strong>:<code>Dict</code>, <strong><code>interoception</code></strong>:<code>Dict</code>, <strong><code>exteroception</code></strong>:<code>Dict</code>, <strong><code>proprioception</code></strong>:<code>Any</code>, <strong><code>object_perception</code></strong>:<code>Any</code>=<em><code>object_perception</code></em>) :: <a href="/ecotwins/animal_classes.html#Organism"><code>Organism</code></a></p>
</blockquote>
<p>Animal(species: str, genome: str, sex: str, age: float, weight: float, position: Any, hyperparameters: Dict[str, float], homeostasis: Dict[str, float], min_homeostasis: Dict[str, float], max_homeostasis: Dict[str, float], homeostatic_effects: Dict[str, float], distances: Dict, perception: Dict, interoception: Dict, exteroception: Dict, proprioception: Any, object_perception: Any = &lt;function Animal.object_perception at 0x7f8955dd7d30&gt;)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider adding a nervous system (or 'brain') with</p>
<ul>
<li>a policy network </li>
<li>a reflex network </li>
<li>a prediction network.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Sheep">Sheep<a class="anchor-link" href="#Sheep"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sheep_radii</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;wolf&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
    <span class="s1">&#39;dandelion&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">}</span>
<span class="n">sheep_def</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;species&#39;</span><span class="p">:</span> <span class="s1">&#39;sheep&#39;</span><span class="p">,</span>
    <span class="s1">&#39;genome&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span>
    <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span>
    <span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
    <span class="s1">&#39;homeostasis&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> 
        <span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mi">37</span><span class="p">,</span>
        <span class="s1">&#39;hormones&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;min_homeostasis&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;water&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
        <span class="s1">&#39;hormones&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;max_homeostasis&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;water&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
        <span class="s1">&#39;hormones&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;homeostatic_effects&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span> <span class="c1"># Nutrition table</span>
        <span class="p">(</span><span class="s1">&#39;eat&#39;</span><span class="p">,</span> <span class="s1">&#39;dandelion&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">},</span>
        <span class="p">(</span><span class="s1">&#39;drink&#39;</span><span class="p">,</span><span class="s1">&#39;water&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="p">},</span>
    <span class="s1">&#39;hyperparameters&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># Biological</span>
        <span class="s1">&#39;max_age&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> 
        <span class="c1"># Physical</span>
        <span class="s1">&#39;delta&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="c1"># stride max_inclination, max_speed (max_values)</span>
        <span class="s1">&#39;close&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="c1"># distance for eating, drinking, attacking, mating</span>
        <span class="c1"># Metabolism: </span>
        <span class="s1">&#39;energy_cost&#39;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span> 
        <span class="s1">&#39;water_cost&#39;</span><span class="p">:</span><span class="mf">0.02</span><span class="p">,</span>
        <span class="c1"># Psychological</span>
        <span class="s1">&#39;gamma&#39;</span><span class="p">:</span><span class="mf">0.9</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c1"># &#39;distances&#39;: lambda: {</span>
    <span class="c1">#     &#39;wolf&#39;: 10, </span>
    <span class="c1">#     &#39;dandelion&#39;: 2,</span>
    <span class="s1">&#39;distances&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">sheep_radii</span><span class="p">,</span>

    <span class="c1"># Till defaultfactoryn (generera en dictionary):</span>
    <span class="s1">&#39;perception&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span><span class="n">Perception</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="n">radius</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sheep_radii</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>

    <span class="s1">&#39;interoception&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> 
        <span class="s1">&#39;water&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">},</span> 
    <span class="s1">&#39;exteroception&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;humidity&#39;</span><span class="p">:</span> <span class="mi">88</span><span class="p">,</span>
    <span class="p">},</span> 
    <span class="s1">&#39;proprioception&#39;</span><span class="p">:</span> <span class="s1">&#39;eat&#39;</span><span class="p">,</span>  <span class="c1"># (0.2,0,9) # move direction + speed or &#39;eat&#39; or &#39;mate&#39; or &#39;idle&#39;</span>
    <span class="s1">&#39;object_perception&#39;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;wolf&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
        <span class="s1">&#39;dandelion&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
        <span class="s1">&#39;sheep&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">}</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Sheep</span><span class="p">(</span><span class="n">Animal</span><span class="p">):</span>
    <span class="n">species</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span>
    <span class="n">genome</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;genome&#39;</span><span class="p">]</span>
    <span class="n">sex</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
    <span class="n">weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">])</span>
    <span class="n">hyperparameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;hyperparameters&#39;</span><span class="p">])</span>
    <span class="n">homeostasis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;homeostasis&#39;</span><span class="p">])</span>
    <span class="n">min_homeostasis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;min_homeostasis&#39;</span><span class="p">])</span>
    <span class="n">max_homeostasis</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;max_homeostasis&#39;</span><span class="p">])</span>
    <span class="n">homeostatic_effects</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;homeostatic_effects&#39;</span><span class="p">])</span>
    <span class="n">distances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;distances&#39;</span><span class="p">])</span>
    <span class="n">perception</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Perception</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;perception&#39;</span><span class="p">])</span>
    <span class="n">interoception</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;interoception&#39;</span><span class="p">])</span>
    <span class="n">exteroception</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;exteroception&#39;</span><span class="p">])</span>
    <span class="n">proprioception</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;proprioception&#39;</span><span class="p">]</span>
    <span class="n">object_perception</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">sheep_def</span><span class="p">[</span><span class="s1">&#39;object_perception&#39;</span><span class="p">])</span>
    <span class="n">action</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">spaces</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">alive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># Depends on homeostasis</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">homeostasis</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">homeostasis</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">[</span><span class="s1">&#39;max_age&#39;</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">happiness</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># Depends on perception like energy (interoception), humidity (exteroception), and smell (object_perception)</span>
        <span class="n">glucose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interoception</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">glucose</span>
    
    <span class="k">def</span> <span class="nf">happiness2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glucose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interoception</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span>
        <span class="n">water</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interoception</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">glucose</span><span class="o">*</span><span class="n">water</span>

    <span class="k">def</span> <span class="nf">happiness3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">glucose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interoception</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span>
        <span class="n">smell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_perception</span><span class="p">[</span><span class="s1">&#39;sheep&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">glucose</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">smell</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">terrain</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="SimpleSheep">SimpleSheep<a class="anchor-link" href="#SimpleSheep"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SimpleSheep" class="doc_header"><code>class</code> <code>SimpleSheep</code><a href="https://github.com/LogicalInvestigations/ecotwins/tree/master/ecotwins/animal_classes.py#L295" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SimpleSheep</code>(<strong><code>species</code></strong>:<code>str</code>=<em><code>'simple_sheep'</code></em>, <strong><code>genome</code></strong>:<code>str</code>=<em><code>''</code></em>, <strong><code>sex</code></strong>:<code>str</code>=<em><code>'male'</code></em>, <strong><code>age</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>weight</code></strong>:<code>float</code>=<em><code>22</code></em>, <strong><code>position</code></strong>:<code>ndarray</code>=<em><code>&lt;factory&gt;</code></em>, <strong><code>hyperparameters</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>min_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>max_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>homeostatic_effects</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>distances</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>interoception</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>exteroception</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>proprioception</code></strong>:<code>str</code>=<em><code>'eat'</code></em>, <strong><code>object_perception</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>action_space</code></strong>:<code>Box</code>=<em><code>&lt;factory&gt;</code></em>, <strong><code>observation_space</code></strong>:<code>Box</code>=<em><code>&lt;factory&gt;</code></em>, <strong><code>use_reward_radius_in_perception</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/ecotwins/animal_classes.html#Animal"><code>Animal</code></a></p>
</blockquote>
<p>SimpleSheep(species: str = 'simple_sheep', genome: str = '', sex: str = 'male', age: float = 0, weight: float = 22, position: numpy.ndarray = <factory>, hyperparameters: Dict[str, float] = <factory>, homeostasis: Dict[str, float] = <factory>, min_homeostasis: Dict[str, float] = <factory>, max_homeostasis: Dict[str, float] = <factory>, homeostatic_effects: Dict[str, float] = <factory>, distances: Dict[str, float] = <factory>, interoception: Dict[str, float] = <factory>, exteroception: Dict[str, float] = <factory>, proprioception: str = 'eat', object_perception: Dict[str, float] = <factory>, action_space: gym.spaces.box.Box = <factory>, observation_space: gym.spaces.box.Box = <factory>, use_reward_radius_in_perception: bool = False)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span>
    <span class="n">shaun</span> <span class="o">=</span> <span class="n">Sheep</span><span class="p">()</span>
    <span class="n">shaun2</span> <span class="o">=</span> <span class="n">Sheep</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">shaun</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="s1">&#39;wolf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">shaun</span><span class="o">.</span><span class="n">alive</span><span class="p">()</span><span class="c1">#happiness()</span>
    <span class="n">shaun</span><span class="p">,</span> <span class="n">shaun2</span>

    <span class="n">shaun2</span> <span class="o">=</span> <span class="n">Sheep</span><span class="p">(</span><span class="n">proprioception</span><span class="o">=</span><span class="s1">&#39;eat&#39;</span><span class="p">)</span>
    <span class="n">shaun2</span><span class="o">.</span><span class="n">position</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">shaun2</span><span class="o">.</span><span class="n">proprioception</span> <span class="o">=</span> <span class="s1">&#39;gamble&#39;</span>
    <span class="n">shaun2</span><span class="o">.</span><span class="n">proprioception</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="MultiSheep">MultiSheep<a class="anchor-link" href="#MultiSheep"> </a></h4><p>A sheep with multiple needs (water energy)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiSheep" class="doc_header"><code>class</code> <code>MultiSheep</code><a href="https://github.com/LogicalInvestigations/ecotwins/tree/master/ecotwins/animal_classes.py#L449" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiSheep</code>(<strong><code>species</code></strong>:<code>str</code>=<em><code>'multi_sheep'</code></em>, <strong><code>genome</code></strong>:<code>str</code>=<em><code>''</code></em>, <strong><code>sex</code></strong>:<code>str</code>=<em><code>'male'</code></em>, <strong><code>age</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>weight</code></strong>:<code>float</code>=<em><code>22</code></em>, <strong><code>position</code></strong>:<code>ndarray</code>=<em><code>&lt;factory&gt;</code></em>, <strong><code>hyperparameters</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>min_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>max_homeostasis</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>homeostatic_effects</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>distances</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>interoception</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>exteroception</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>proprioception</code></strong>:<code>str</code>=<em><code>'eat'</code></em>, <strong><code>object_perception</code></strong>:<code>Dict</code>[<code>str</code>, <code>float</code>]=<em><code>&lt;factory&gt;</code></em>, <strong><code>action_space</code></strong>:<code>Box</code>=<em><code>&lt;factory&gt;</code></em>, <strong><code>use_interoception_as_obs</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>use_intensity_as_obs</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>use_happiness_as_obs</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>use_reward_radius_in_perception</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>use_multi_direction</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>use_single_direction</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>action_noise</code></strong>:<code>float</code>=<em><code>0.0</code></em>, <strong><code>normalize_action</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>perception_noise</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>n_frames</code></strong>:<code>int</code>=<em><code>1</code></em>) :: <a href="/ecotwins/animal_classes.html#Animal"><code>Animal</code></a></p>
</blockquote>
<p>MultiSheep(species: str = 'multi_sheep', genome: str = '', sex: str = 'male', age: float = 0, weight: float = 22, position: numpy.ndarray = <factory>, hyperparameters: Dict[str, float] = <factory>, homeostasis: Dict[str, float] = <factory>, min_homeostasis: Dict[str, float] = <factory>, max_homeostasis: Dict[str, float] = <factory>, homeostatic_effects: Dict[str, float] = <factory>, distances: Dict[str, float] = <factory>, interoception: Dict[str, float] = <factory>, exteroception: Dict[str, float] = <factory>, proprioception: str = 'eat', object_perception: Dict[str, float] = <factory>, action_space: gym.spaces.box.Box = <factory>, use_interoception_as_obs: bool = False, use_intensity_as_obs: bool = False, use_happiness_as_obs: bool = False, use_reward_radius_in_perception: bool = False, use_multi_direction: bool = True, use_single_direction: bool = False, action_noise: float = 0.0, normalize_action: bool = True, perception_noise: float = 0, n_frames: int = 1)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span>
    <span class="n">dolly</span> <span class="o">=</span> <span class="n">MultiSheep</span><span class="p">(</span><span class="n">distances</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;dandelion&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
    <span class="n">dolly</span><span class="o">.</span><span class="n">interoception</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">Terrain</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;water&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;dandelion&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="c1">#     e = Ecosystem(dolly, t)</span>
    <span class="n">dolly</span><span class="o">.</span><span class="n">happiness</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">dolly</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">t</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ecosystem">Ecosystem<a class="anchor-link" href="#Ecosystem"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># class Population:</span>
<span class="c1">#     animals: List[Animal]</span>
<span class="c1">#     plants: List[Plant]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Ecosystem" class="doc_header"><code>class</code> <code>Ecosystem</code><a href="https://github.com/LogicalInvestigations/ecotwins/tree/master/ecotwins/animal_classes.py#L657" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Ecosystem</code>(<strong><code>terrain</code></strong>:<a href="/ecotwins/animal_classes.html#Terrain"><code>Terrain</code></a>, <strong><code>agent</code></strong>:<a href="/ecotwins/animal_classes.html#Animal"><code>Animal</code></a>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ecosystem-updates">Ecosystem updates<a class="anchor-link" href="#Ecosystem-updates"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">exteroception</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span><span class="n">ecosystem</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ecosystem</span><span class="o">.</span><span class="n">terrain</span><span class="o">.</span><span class="n">conditions</span><span class="p">(</span><span class="n">animal</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>

<span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span> <span class="n">exteroception</span><span class="p">(</span><span class="n">shaun</span><span class="p">,</span><span class="n">eco</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">proprioception</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span><span class="n">ecosystem</span><span class="p">):</span>
    <span class="c1"># Dummy. Should return the last action</span>
    <span class="k">return</span> <span class="n">animal</span><span class="o">.</span><span class="n">proprioception</span>

<span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span> <span class="n">proprioception</span><span class="p">(</span><span class="n">shaun</span><span class="p">,</span><span class="n">eco</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">homeostasis</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span> <span class="n">ecosystem</span><span class="p">):</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">animal</span><span class="o">.</span><span class="n">homeostasis</span>
    <span class="c1"># Independent of actions</span>
    <span class="n">new</span><span class="p">[</span><span class="s2">&quot;temp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exteroception</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span> <span class="n">ecosystem</span><span class="p">)[</span><span class="s2">&quot;temp&quot;</span><span class="p">]</span>  <span class="c1"># snake</span>
    <span class="n">new</span><span class="p">[</span><span class="s2">&quot;hormones&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">new</span><span class="p">[</span><span class="s2">&quot;hormones&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">animal</span><span class="o">.</span><span class="n">max_homeostasis</span><span class="p">[</span><span class="s2">&quot;hormones&quot;</span><span class="p">])</span>

    <span class="c1"># Dependent of actions</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">animal</span><span class="o">.</span><span class="n">proprioception</span>

    <span class="c1">## Independent of close objects</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">action</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,):</span>  <span class="c1"># when the action is &#39;move&#39;</span>
        <span class="n">new</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">animal</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">[</span>
            <span class="s2">&quot;energy_cost&quot;</span>
        <span class="p">]</span>  <span class="c1"># 0.01 # multiply with speed?</span>
        <span class="n">new</span><span class="p">[</span><span class="s2">&quot;water&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">animal</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">[</span><span class="s2">&quot;water_cost&quot;</span><span class="p">]</span>  <span class="c1"># multiply with speed?</span>

    <span class="c1">## Dependent of close objects</span>
    <span class="c1"># for organism in ecosystem.organisms:  # Go through the organisms</span>
    <span class="k">for</span> <span class="n">organism</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ecosystem</span><span class="o">.</span><span class="n">agent</span><span class="p">]:</span>  <span class="c1"># Go through the organisms</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;organism&quot;</span><span class="p">,</span> <span class="n">organism</span><span class="p">,</span> <span class="s2">&quot;animal&quot;</span><span class="p">,</span> <span class="n">animal</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">organism</span> <span class="o">!=</span> <span class="n">animal</span>
            <span class="ow">and</span> <span class="n">distance</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">animal</span><span class="o">.</span><span class="n">position</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">organism</span><span class="o">.</span><span class="n">position</span><span class="p">))</span>
            <span class="o">&lt;=</span> <span class="n">animal</span><span class="o">.</span><span class="n">hyperparameters</span><span class="p">[</span><span class="s2">&quot;close&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;eat&quot;</span><span class="p">:</span>  <span class="c1"># or action == &#39;drink&#39; or action == &#39;consume&#39;:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">animal</span><span class="o">.</span><span class="n">homeostatic_effects</span><span class="p">:</span>  <span class="c1"># Go through the nutrients</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;eat&quot;</span><span class="p">,</span> <span class="n">organism</span><span class="o">.</span><span class="n">species</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">nutrient</span> <span class="ow">in</span> <span class="n">animal</span><span class="o">.</span><span class="n">homeostatic_effects</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                            <span class="n">new</span><span class="p">[</span><span class="n">nutrient</span><span class="p">]</span> <span class="o">+=</span> <span class="n">animal</span><span class="o">.</span><span class="n">homeostatic_effects</span><span class="p">[</span><span class="n">key</span><span class="p">][</span>
                                <span class="n">nutrient</span>
                            <span class="p">]</span>  <span class="c1"># Add nutrients. hormones??</span>
                            <span class="n">new</span><span class="p">[</span><span class="n">nutrient</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                                <span class="n">new</span><span class="p">[</span><span class="n">nutrient</span><span class="p">],</span> <span class="n">animal</span><span class="o">.</span><span class="n">max_homeostasis</span><span class="p">[</span><span class="n">nutrient</span><span class="p">]</span>
                            <span class="p">)</span>
            <span class="c1"># How do we handle the &#39;eat air&#39; case?</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;mate&quot;</span>
                <span class="ow">and</span> <span class="n">animal</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="n">type</span>
                <span class="ow">and</span> <span class="n">animal</span><span class="o">.</span><span class="n">sex</span> <span class="o">!=</span> <span class="nb">object</span><span class="o">.</span><span class="n">sex</span>
            <span class="p">):</span>
                <span class="n">new</span><span class="p">[</span><span class="s2">&quot;hormones&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Lower the hormone level</span>
            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;attack&quot;</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Lower homeostasis of the other animal (too)</span>
    <span class="k">return</span> <span class="n">new</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span> <span class="n">homeostasis</span><span class="p">(</span><span class="n">shaun</span><span class="p">,</span><span class="n">eco</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>organism Sheep(species=&#39;sheep&#39;, genome=&#39;&#39;, sex=&#39;male&#39;, age=3, weight=22, position=array([0., 0.]), hyperparameters={&#39;max_age&#39;: 100, &#39;delta&#39;: 0.01, &#39;close&#39;: 0.01, &#39;energy_cost&#39;: 0.01, &#39;water_cost&#39;: 0.02, &#39;gamma&#39;: 0.9}, homeostasis={&#39;energy&#39;: 3, &#39;water&#39;: 2, &#39;temp&#39;: 11, &#39;hormones&#39;: 10}, min_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 30, &#39;hormones&#39;: 0}, max_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 40, &#39;hormones&#39;: 10}, homeostatic_effects={(&#39;eat&#39;, &#39;dandelion&#39;): {&#39;energy&#39;: 1, &#39;water&#39;: 0.2}, (&#39;drink&#39;, &#39;water&#39;): {&#39;energy&#39;: 0, &#39;water&#39;: 1}}, distances={&#39;wolf&#39;: 100, &#39;dandelion&#39;: 2}, perception={&#39;wolf&#39;: Perception(radius=10, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0), &#39;dandelion&#39;: Perception(radius=2, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0)}, interoception={&#39;energy&#39;: 3, &#39;water&#39;: 2}, exteroception={&#39;temp&#39;: 10, &#39;humidity&#39;: 88}, proprioception=&#39;eat&#39;, object_perception={&#39;wolf&#39;: (1, 2, 10.0), &#39;dandelion&#39;: (3, 3, 2.0), &#39;sheep&#39;: (3, 3, 2.0)}, action=Box(-1.0, 1.0, (2,), float16)) animal Sheep(species=&#39;sheep&#39;, genome=&#39;&#39;, sex=&#39;male&#39;, age=3, weight=22, position=array([0., 0.]), hyperparameters={&#39;max_age&#39;: 100, &#39;delta&#39;: 0.01, &#39;close&#39;: 0.01, &#39;energy_cost&#39;: 0.01, &#39;water_cost&#39;: 0.02, &#39;gamma&#39;: 0.9}, homeostasis={&#39;energy&#39;: 3, &#39;water&#39;: 2, &#39;temp&#39;: 11, &#39;hormones&#39;: 10}, min_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 30, &#39;hormones&#39;: 0}, max_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 40, &#39;hormones&#39;: 10}, homeostatic_effects={(&#39;eat&#39;, &#39;dandelion&#39;): {&#39;energy&#39;: 1, &#39;water&#39;: 0.2}, (&#39;drink&#39;, &#39;water&#39;): {&#39;energy&#39;: 0, &#39;water&#39;: 1}}, distances={&#39;wolf&#39;: 100, &#39;dandelion&#39;: 2}, perception={&#39;wolf&#39;: Perception(radius=10, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0), &#39;dandelion&#39;: Perception(radius=2, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0)}, interoception={&#39;energy&#39;: 3, &#39;water&#39;: 2}, exteroception={&#39;temp&#39;: 10, &#39;humidity&#39;: 88}, proprioception=&#39;eat&#39;, object_perception={&#39;wolf&#39;: (1, 2, 10.0), &#39;dandelion&#39;: (3, 3, 2.0), &#39;sheep&#39;: (3, 3, 2.0)}, action=Box(-1.0, 1.0, (2,), float16))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span> <span class="n">homeostasis</span><span class="p">(</span><span class="n">shaun2</span><span class="p">,</span><span class="n">eco</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>organism Sheep(species=&#39;sheep&#39;, genome=&#39;&#39;, sex=&#39;male&#39;, age=3, weight=22, position=array([0., 0.]), hyperparameters={&#39;max_age&#39;: 100, &#39;delta&#39;: 0.01, &#39;close&#39;: 0.01, &#39;energy_cost&#39;: 0.01, &#39;water_cost&#39;: 0.02, &#39;gamma&#39;: 0.9}, homeostasis={&#39;energy&#39;: 3, &#39;water&#39;: 2, &#39;temp&#39;: 11, &#39;hormones&#39;: 10}, min_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 30, &#39;hormones&#39;: 0}, max_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 40, &#39;hormones&#39;: 10}, homeostatic_effects={(&#39;eat&#39;, &#39;dandelion&#39;): {&#39;energy&#39;: 1, &#39;water&#39;: 0.2}, (&#39;drink&#39;, &#39;water&#39;): {&#39;energy&#39;: 0, &#39;water&#39;: 1}}, distances={&#39;wolf&#39;: 100, &#39;dandelion&#39;: 2}, perception={&#39;wolf&#39;: Perception(radius=10, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0), &#39;dandelion&#39;: Perception(radius=2, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0)}, interoception={&#39;energy&#39;: 3, &#39;water&#39;: 2}, exteroception={&#39;temp&#39;: 10, &#39;humidity&#39;: 88}, proprioception=&#39;eat&#39;, object_perception={&#39;wolf&#39;: (1, 2, 10.0), &#39;dandelion&#39;: (3, 3, 2.0), &#39;sheep&#39;: (3, 3, 2.0)}, action=Box(-1.0, 1.0, (2,), float16)) animal Sheep(species=&#39;sheep&#39;, genome=&#39;&#39;, sex=&#39;male&#39;, age=3, weight=22, position=array([0.8239868 , 0.35588226]), hyperparameters={&#39;max_age&#39;: 100, &#39;delta&#39;: 0.01, &#39;close&#39;: 0.01, &#39;energy_cost&#39;: 0.01, &#39;water_cost&#39;: 0.02, &#39;gamma&#39;: 0.9}, homeostasis={&#39;energy&#39;: 3, &#39;water&#39;: 2, &#39;temp&#39;: 11, &#39;hormones&#39;: 10}, min_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 30, &#39;hormones&#39;: 0}, max_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 40, &#39;hormones&#39;: 10}, homeostatic_effects={(&#39;eat&#39;, &#39;dandelion&#39;): {&#39;energy&#39;: 1, &#39;water&#39;: 0.2}, (&#39;drink&#39;, &#39;water&#39;): {&#39;energy&#39;: 0, &#39;water&#39;: 1}}, distances={&#39;wolf&#39;: 100, &#39;dandelion&#39;: 2}, perception={&#39;wolf&#39;: Perception(radius=100, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0), &#39;dandelion&#39;: Perception(radius=2, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0)}, interoception={&#39;energy&#39;: 3, &#39;water&#39;: 2}, exteroception={&#39;temp&#39;: 10, &#39;humidity&#39;: 88}, proprioception=&#39;gamble&#39;, object_perception={&#39;wolf&#39;: (1, 2, 10.0), &#39;dandelion&#39;: (3, 3, 2.0), &#39;sheep&#39;: (3, 3, 2.0)}, action=Box(-1.0, 1.0, (2,), float16))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">interoception</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span><span class="n">ecosystem</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">homeostasis</span><span class="p">(</span><span class="n">animal</span><span class="p">,</span><span class="n">ecosystem</span><span class="p">)</span>

<span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span> <span class="n">interoception</span><span class="p">(</span><span class="n">shaun</span><span class="p">,</span><span class="n">eco</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>organism Sheep(species=&#39;sheep&#39;, genome=&#39;&#39;, sex=&#39;male&#39;, age=3, weight=22, position=array([0., 0.]), hyperparameters={&#39;max_age&#39;: 100, &#39;delta&#39;: 0.01, &#39;close&#39;: 0.01, &#39;energy_cost&#39;: 0.01, &#39;water_cost&#39;: 0.02, &#39;gamma&#39;: 0.9}, homeostasis={&#39;energy&#39;: 3, &#39;water&#39;: 2, &#39;temp&#39;: 11, &#39;hormones&#39;: 10}, min_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 30, &#39;hormones&#39;: 0}, max_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 40, &#39;hormones&#39;: 10}, homeostatic_effects={(&#39;eat&#39;, &#39;dandelion&#39;): {&#39;energy&#39;: 1, &#39;water&#39;: 0.2}, (&#39;drink&#39;, &#39;water&#39;): {&#39;energy&#39;: 0, &#39;water&#39;: 1}}, distances={&#39;wolf&#39;: 100, &#39;dandelion&#39;: 2}, perception={&#39;wolf&#39;: Perception(radius=10, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0), &#39;dandelion&#39;: Perception(radius=2, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0)}, interoception={&#39;energy&#39;: 3, &#39;water&#39;: 2}, exteroception={&#39;temp&#39;: 10, &#39;humidity&#39;: 88}, proprioception=&#39;eat&#39;, object_perception={&#39;wolf&#39;: (1, 2, 10.0), &#39;dandelion&#39;: (3, 3, 2.0), &#39;sheep&#39;: (3, 3, 2.0)}, action=Box(-1.0, 1.0, (2,), float16)) animal Sheep(species=&#39;sheep&#39;, genome=&#39;&#39;, sex=&#39;male&#39;, age=3, weight=22, position=array([0., 0.]), hyperparameters={&#39;max_age&#39;: 100, &#39;delta&#39;: 0.01, &#39;close&#39;: 0.01, &#39;energy_cost&#39;: 0.01, &#39;water_cost&#39;: 0.02, &#39;gamma&#39;: 0.9}, homeostasis={&#39;energy&#39;: 3, &#39;water&#39;: 2, &#39;temp&#39;: 11, &#39;hormones&#39;: 10}, min_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 30, &#39;hormones&#39;: 0}, max_homeostasis={&#39;energy&#39;: 10, &#39;water&#39;: 10, &#39;temp&#39;: 40, &#39;hormones&#39;: 10}, homeostatic_effects={(&#39;eat&#39;, &#39;dandelion&#39;): {&#39;energy&#39;: 1, &#39;water&#39;: 0.2}, (&#39;drink&#39;, &#39;water&#39;): {&#39;energy&#39;: 0, &#39;water&#39;: 1}}, distances={&#39;wolf&#39;: 100, &#39;dandelion&#39;: 2}, perception={&#39;wolf&#39;: Perception(radius=10, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0), &#39;dandelion&#39;: Perception(radius=2, origin=array([0., 0.]), steven_exponent=0.6, reward_radius=0.0, epsilon=0.31622776601683794, use_clip=False, direction_noise=0)}, interoception={&#39;energy&#39;: 3, &#39;water&#39;: 2}, exteroception={&#39;temp&#39;: 10, &#39;humidity&#39;: 88}, proprioception=&#39;eat&#39;, object_perception={&#39;wolf&#39;: (1, 2, 10.0), &#39;dandelion&#39;: (3, 3, 2.0), &#39;sheep&#39;: (3, 3, 2.0)}, action=Box(-1.0, 1.0, (2,), float16))
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">object_perception</span><span class="p">(</span><span class="n">animal</span><span class="p">:</span> <span class="n">Animal</span><span class="p">,</span> <span class="n">ecosystem</span><span class="p">:</span> <span class="n">Ecosystem</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="p">[</span><span class="n">organism</span><span class="o">.</span><span class="n">position</span> <span class="k">for</span> <span class="n">organism</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ecosystem</span><span class="o">.</span><span class="n">agent</span><span class="p">]]</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">animal</span><span class="o">.</span><span class="n">distances</span><span class="p">[</span><span class="n">kind</span><span class="p">]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Perception</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="n">animal</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">steven_exponent</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">visible</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">visible</span><span class="p">(</span><span class="n">animal</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">multi_direction</span><span class="p">(</span><span class="n">animal</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="n">visible</span><span class="p">)</span>

<span class="k">if</span> <span class="n">IN_MAIN</span><span class="p">:</span>
    <span class="n">object_perception</span><span class="p">(</span><span class="n">shaun</span><span class="p">,</span><span class="n">eco</span><span class="p">,</span> <span class="s1">&#39;wolf&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-202-387255548084&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> 
<span class="ansi-green-intense-fg ansi-bold">     10</span> <span class="ansi-green-fg">if</span> IN_MAIN<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 11</span><span class="ansi-red-fg">     </span>object_perception<span class="ansi-blue-fg">(</span>shaun<span class="ansi-blue-fg">,</span>eco<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39;wolf&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-202-387255548084&gt;</span> in <span class="ansi-cyan-fg">object_perception</span><span class="ansi-blue-fg">(animal, ecosystem, kind)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>     radius <span class="ansi-blue-fg">=</span> animal<span class="ansi-blue-fg">.</span>distances<span class="ansi-blue-fg">[</span>kind<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>     p <span class="ansi-blue-fg">=</span> Perception<span class="ansi-blue-fg">(</span>radius<span class="ansi-blue-fg">,</span> animal<span class="ansi-blue-fg">.</span>position<span class="ansi-blue-fg">,</span> steven_exponent<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.6</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 7</span><span class="ansi-red-fg">     </span>visible <span class="ansi-blue-fg">=</span> p<span class="ansi-blue-fg">.</span>visible<span class="ansi-blue-fg">(</span>animal<span class="ansi-blue-fg">.</span>position<span class="ansi-blue-fg">,</span> positions<span class="ansi-blue-fg">,</span> radius<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span>     <span class="ansi-green-fg">return</span> p<span class="ansi-blue-fg">.</span>multi_direction<span class="ansi-blue-fg">(</span>animal<span class="ansi-blue-fg">.</span>position<span class="ansi-blue-fg">,</span> visible<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> 

<span class="ansi-green-fg">/w10/Users/niklas/Documents/AI AGI DT/ecotwin/gh_repo/ecotwins/ecotwins/perception.py</span> in <span class="ansi-cyan-fg">visible</span><span class="ansi-blue-fg">(self, position, objects, radius)</span>
<span class="ansi-green-intense-fg ansi-bold">    107</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>total_intensity<span class="ansi-blue-fg">(</span>position<span class="ansi-blue-fg">,</span> closest_point<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    108</span> 
<span class="ansi-green-fg">--&gt; 109</span><span class="ansi-red-fg">     </span><span class="ansi-red-fg"># Filters out the visible objects from position.</span>
<span class="ansi-green-intense-fg ansi-bold">    110</span>     <span class="ansi-green-fg">def</span> visible<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> position<span class="ansi-blue-fg">,</span> objects<span class="ansi-blue-fg">,</span> radius<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    111</span>         <span class="ansi-green-fg">if</span> radius <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/w10/Users/niklas/Documents/AI AGI DT/ecotwin/gh_repo/ecotwins/ecotwins/perception.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">    107</span>         <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>total_intensity<span class="ansi-blue-fg">(</span>position<span class="ansi-blue-fg">,</span> closest_point<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    108</span> 
<span class="ansi-green-fg">--&gt; 109</span><span class="ansi-red-fg">     </span><span class="ansi-red-fg"># Filters out the visible objects from position.</span>
<span class="ansi-green-intense-fg ansi-bold">    110</span>     <span class="ansi-green-fg">def</span> visible<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> position<span class="ansi-blue-fg">,</span> objects<span class="ansi-blue-fg">,</span> radius<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    111</span>         <span class="ansi-green-fg">if</span> radius <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">NameError</span>: name &#39;distance&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">ecosystem</span><span class="p">):</span>
    <span class="c1"># new = ecosystem</span>
    <span class="c1"># new.terrain = new.terrain # Maybe add weather and light conditions. Time...</span>
    <span class="c1"># new.organisms.positions, homeostasis, perception)</span>
    <span class="c1"># new terrain</span>
    <span class="c1"># return new</span>
    <span class="n">pass1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Discussion">Discussion<a class="anchor-link" href="#Discussion"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comments">Comments<a class="anchor-link" href="#Comments"> </a></h2><ul>
<li>What is Sheep doing now?</li>
<li>Replace SimpleSheep with Moth?</li>
<li>MultiSheep handles n object types and automatic consumption</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Improvements?">Improvements?<a class="anchor-link" href="#Improvements?"> </a></h3><ul>
<li>Turn alive into a concrete class function in Organism</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Next-step?">Next step?<a class="anchor-link" href="#Next-step?"> </a></h3><ul>
<li><p>Moth. Taxis can be based on object perception, e.g. a moth that is attracted to light bulbs. Happiness = total_intensity. The moth stays on the light bulb until it disappears. Then it flies on. Receives direction info.</p>
</li>
<li><p>Silverfish. Silverfish dislike light bulbs. Happiness = -total_intensity. Receives direction info. Moves away from the gradient</p>
</li>
<li><p>Pill bug. Taxis can also be based on exteroception, e.g. a pill bug that is attracted to humidity. Happiness = humidity. Receives no direction info (but maybe from two antennae). But might escape in a direction, so still taxis. Add speed (or effort) in [0,1] as addition to action space.</p>
</li>
<li><p>Cat (with speed output).</p>
<ul>
<li>Add speed (or torque or effort or energy) in [0,1] to the action space</li>
<li>Add gradient_intensity to the object perception (type, direction, total_intensity, gradient_intensity)</li>
</ul>
</li>
<li><p>Social sheep.</p>
<ul>
<li>Happiness = energy (0.6 + 0.4 oxytocin) </li>
</ul>
</li>
<li><p>Modest sheep.</p>
<ul>
<li>Happiness function with diminishing return?</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span><span class="p">;</span> <span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
Converted animal_classes.ipynb.
Converted animation_helper.ipynb.
Converted ecoenv.ipynb.
Converted happiness.ipynb.
Converted index.ipynb.
Converted perception.ipynb.
Converted reflex_agent.ipynb.
Converted tyckande.ipynb.
Converted utility.ipynb.
Converted worlds.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

